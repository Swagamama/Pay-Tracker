<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pay Tracker Pro</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --bg: #f9fafb;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
    }
    body.dark {
      --bg: #111827;
      --card: #1f2937;
      --text: #f9fafb;
      --muted: #9ca3af;
    }
    body {
      background: var(--bg);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      min-height: 100vh;
      margin: 0; padding: 1rem;
      color: var(--text);
      transition: background 0.3s, color 0.3s;
    }
    .container { max-width: 32rem; margin: auto; }
    .card {
      background: var(--card); border-radius: 1.25rem;
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
      padding: 1.5rem; margin-bottom: 1rem;
    }
    .header { display:flex; justify-content:space-between; align-items:center; }
    .title { font-size: 1.5rem; font-weight: 700; }
    .toggle-dark { cursor:pointer; font-size: 1.2rem; }
    .pay-display { text-align:center; position: sticky; top:0; background:var(--card); padding:1rem; z-index:10; }
    .pay-amount { font-size:2.5rem; font-weight:800; color:#059669; }
    .time-worked { margin-top:0.5rem; font-size:1rem; color:var(--muted); }
    .btn { padding:0.75rem 1rem; font-weight:600; border:none; border-radius:0.75rem; cursor:pointer; margin:0.25rem; }
    .btn-green { background:#10b981; color:white; }
    .btn-blue { background:#3b82f6; color:white; }
    .btn-orange { background:#f97316; color:white; }
    .btn-gray { background:#6b7280; color:white; }
    .btn-small { font-size:0.9rem; }
    .goal { margin-top:1rem; }
    .progress { background:#e5e7eb; border-radius:0.5rem; overflow:hidden; height:1rem; }
    .progress-bar { height:100%; background:#10b981; width:0%; transition:width 0.3s; }
    .history { font-size:0.9rem; color:var(--muted); }
    .footer { text-align:center; font-size:0.75rem; margin-top:1rem; color:var(--muted); }
  </style>
</head>
<body>
  <div class="container">
    <div class="card header">
      <div class="title">Pay Tracker Pro</div>
      <div id="darkToggle" class="toggle-dark"><i class="fas fa-moon"></i></div>
    </div>

    <div id="setupCard" class="card">
      <label>Hourly Rate ($)</label>
      <input id="hourlyRateInput" type="number" step="0.01" placeholder="Enter hourly rate" class="input"/>
      <label>Preset Jobs</label>
      <select id="presetSelect" class="input">
        <option value="">-- Select Job --</option>
        <option value="28">üè≠ Factory ‚Äî $28/hr</option>
        <option value="35">üöó Delivery ‚Äî $35/hr</option>
        <option value="50">üñ•Ô∏è Freelance ‚Äî $50/hr</option>
      </select>
      <button id="startWorkBtn" class="btn btn-green btn-full"><i class="fas fa-play"></i> Start Working</button>
    </div>

    <div id="workCard" class="card hidden">
      <div class="pay-display">
        <div id="payAmount" class="pay-amount">$0.00</div>
        <div id="timeWorked" class="time-worked">0:00 worked</div>
        <div id="hourlyRateDisplay" class="hourly-rate">$0/hour</div>
      </div>

      <div>
        <button id="pauseBtn" class="btn btn-blue btn-small"><i class="fas fa-pause"></i> Pause Work</button>
        <select id="breakSelect" class="input btn-small">
          <option value="300">5 min</option>
          <option value="900">15 min</option>
          <option value="1800" selected>30 min</option>
          <option value="3600">1 hr</option>
        </select>
        <button id="breakBtn" class="btn btn-orange btn-small"><i class="fas fa-coffee"></i> Break</button>
        <button id="resetBtn" class="btn btn-gray btn-small"><i class="fas fa-undo"></i> Reset</button>
        <button id="exportBtn" class="btn btn-green btn-small"><i class="fas fa-file-export"></i> Export CSV</button>
      </div>

      <div class="goal">
        <label>Savings Goal ($)</label>
        <input id="goalInput" type="number" placeholder="Enter goal amount"/>
        <div class="progress"><div id="progressBar" class="progress-bar"></div></div>
      </div>
    </div>

    <div class="card history">
      <div id="dailyTotal">Today: $0.00 (0h 0m)</div>
      <div id="weeklyTotal">This Week: $0.00 (0h 0m)</div>
    </div>

    <div class="footer">Made for workers ‚Äî track time, breaks & pay easily</div>
  </div>

  <script>
    class PayTrackerPro {
      constructor() {
        this.isWorking=false; this.isPaused=false;
        this.hourlyRate=0; this.workStartTime=null; this.totalWorkedMs=0;
        this.breakDuration=1800; this.logs=JSON.parse(localStorage.getItem('logs')||'[]');
        this.goal=0;
        this.loadState(); this.startLoops();
        this.updateHistory();
      }
      saveState(){
        localStorage.setItem('trackerState',JSON.stringify({
          hourlyRate:this.hourlyRate,isWorking:this.isWorking,isPaused:this.isPaused,
          workStartTime:this.workStartTime,totalWorkedMs:this.totalWorkedMs,goal:this.goal
        }));
        localStorage.setItem('logs',JSON.stringify(this.logs));
      }
      loadState(){
        const s=localStorage.getItem('trackerState'); if(s){Object.assign(this,JSON.parse(s));}
      }
      formatTime(sec){
        const h=Math.floor(sec/3600),m=Math.floor((sec%3600)/60);
        return `${h}h ${m}m`;
      }
      formatPay(ms){
        return (ms/(1000*60*60)*this.hourlyRate).toLocaleString("en-US",{style:"currency",currency:"USD"});
      }
      calculatePay(){
        let ms=this.totalWorkedMs;
        if(this.isWorking&&!this.isPaused) ms+=Date.now()-this.workStartTime;
        return ms/(1000*60*60)*this.hourlyRate;
      }
      calculateWorked(){
        let ms=this.totalWorkedMs;
        if(this.isWorking&&!this.isPaused) ms+=Date.now()-this.workStartTime;
        return Math.floor(ms/1000);
      }
      updateDisplay(){
        document.getElementById('payAmount').textContent=this.calculatePay().toLocaleString("en-US",{style:"currency",currency:"USD"});
        document.getElementById('timeWorked').textContent=this.formatTime(this.calculateWorked());
        document.getElementById('hourlyRateDisplay').textContent=`$${this.hourlyRate}/hour`;
        this.updateGoal();
        this.saveState();
      }
      updateGoal(){
        if(!this.goal) return;
        const earned=this.logs.reduce((a,b)=>a+b.pay,0)+this.calculatePay();
        const pct=Math.min(100,earned/this.goal*100);
        document.getElementById('progressBar').style.width=pct+"%";
      }
      updateHistory(){
        const today=new Date().toDateString();
        const weekStart=new Date(); weekStart.setDate(weekStart.getDate()-weekStart.getDay());
        const d=this.logs.filter(l=>new Date(l.date).toDateString()==today);
        const w=this.logs.filter(l=>new Date(l.date)>=weekStart);
        const sum=(arr)=>arr.reduce((a,b)=>({pay:a.pay+b.pay,ms:a.ms+b.ms}),{pay:0,ms:0});
        const ds=sum(d), ws=sum(w);
        document.getElementById('dailyTotal').textContent=`Today: ${ds.pay.toLocaleString("en-US",{style:"currency",currency:"USD"})} (${this.formatTime(ds.ms/1000)})`;
        document.getElementById('weeklyTotal').textContent=`This Week: ${ws.pay.toLocaleString("en-US",{style:"currency",currency:"USD"})} (${this.formatTime(ws.ms/1000)})`;
      }
      startWork(rate){this.hourlyRate=rate; this.isWorking=true; this.isPaused=false; this.workStartTime=Date.now(); this.totalWorkedMs=0;
        document.getElementById('setupCard').classList.add('hidden'); document.getElementById('workCard').classList.remove('hidden');}
      togglePause(){
        const btn=document.getElementById('pauseBtn');
        if(!this.isWorking) return;
        if(!this.isPaused){this.totalWorkedMs+=Date.now()-this.workStartTime; this.isPaused=true; btn.innerHTML='<i class="fas fa-play"></i> Resume'; btn.classList.remove('btn-blue'); btn.classList.add('btn-green');}
        else{this.workStartTime=Date.now(); this.isPaused=false; btn.innerHTML='<i class="fas fa-pause"></i> Pause'; btn.classList.remove('btn-green'); btn.classList.add('btn-blue');}
      }
      reset(){
        const pay=this.calculatePay(); const sec=this.calculateWorked();
        this.logs.push({date:new Date(),pay:pay,ms:sec*1000});
        alert(`Shift Ended: ${this.formatTime(sec)}, ${pay.toLocaleString("en-US",{style:"currency",currency:"USD"})} earned.`);
        this.isWorking=false; this.isPaused=false; this.totalWorkedMs=0; this.workStartTime=null;
        document.getElementById('setupCard').classList.remove('hidden'); document.getElementById('workCard').classList.add('hidden');
        this.updateHistory();
      }
      exportCSV(){
        let csv="Date,Hours Worked,Pay\n";
        this.logs.forEach(l=>csv+=`${new Date(l.date).toLocaleString()},${(l.ms/1000/3600).toFixed(2)},${l.pay}\n`);
        const blob=new Blob([csv],{type:'text/csv'}); const url=URL.createObjectURL(blob);
        const a=document.createElement('a'); a.href=url; a.download="pay_log.csv"; a.click();
      }
      startLoops(){setInterval(()=>this.updateDisplay(),1000);}
    }

    const tracker=new PayTrackerPro();
    document.getElementById("startWorkBtn").onclick=()=>{let r=parseFloat(document.getElementById("hourlyRateInput").value)||parseFloat(document.getElementById("presetSelect").value); if(r) tracker.startWork(r); else alert("Enter rate");};
    document.getElementById("pauseBtn").onclick=()=>tracker.togglePause();
    document.getElementById("resetBtn").onclick=()=>tracker.reset();
    document.getElementById("exportBtn").onclick=()=>tracker.exportCSV();
    document.getElementById("goalInput").onchange=(e)=>{tracker.goal=parseFloat(e.target.value)||0; tracker.updateGoal();};
    document.getElementById("darkToggle").onclick=()=>{document.body.classList.toggle('dark'); localStorage.setItem('darkMode',document.body.classList.contains('dark'));};
    if(localStorage.getItem('darkMode')==='true') document.body.classList.add('dark');
  </script>
</body>
</html>
